"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2373],{2373:(k,p,a)=>{a.r(p),a.d(p,{ProfilePageModule:()=>F});var M=a(177),m=a(4341),s=a(4742),P=a(5171),f=a(467),d=a(4262),v=a(5621),g=a(6946),h=a(3114),e=a(4438),y=a(4796);const N=[{path:"",component:(()=>{var r;class c{constructor(t,i,l,o,n){this.firestore=t,this.storage=i,this.auth=l,this.router=o,this.authService=n,this.firstName="",this.lastName="",this.profilePictureUrl="",this.selectedFile=null,this.currentUser=null,this.selectedImage=null}ngOnInit(){(0,v.hg)(this.auth,t=>{t&&(this.currentUser=t,this.loadUserProfile())})}isAuthenticated(){return null!==this.currentUser}selectImage(){var t=this;return(0,f.A)(function*(){console.log("seleccionando foto...");const i=yield h.i7.getPhoto({quality:90,allowEditing:!1,resultType:h.LK.DataUrl,source:h.ru.Prompt});t.selectedImage=i.dataUrl})()}loadUserProfile(){var t=this;return(0,f.A)(function*(){var i;if(null!==(i=t.currentUser)&&void 0!==i&&i.uid){const l=(0,d.H9)(t.firestore,`users/${t.currentUser.uid}`),o=yield(0,d.x7)(l);if(o.exists()){const n=o.data();t.firstName=(null==n?void 0:n.firstName)||"",t.lastName=(null==n?void 0:n.lastName)||"",t.profilePictureUrl=(null==n?void 0:n.profilePictureUrl)||""}}})()}onFileSelected(t){this.selectedFile=t.target.files[0]}saveProfile(){var t=this;return(0,f.A)(function*(){var i;if(null!==(i=t.currentUser)&&void 0!==i&&i.uid){const l=t.currentUser.uid;t.selectedFile&&(t.profilePictureUrl=yield t.uploadProfilePicture(t.selectedFile,l)),yield t.updateProfile(l,t.firstName,t.lastName,t.profilePictureUrl)}})()}uploadProfilePicture(t,i){var l=this;return(0,f.A)(function*(){const n=(0,g.KR)(l.storage,`profile-pictures/${i}/${t.name}`);return yield(0,g.D)(n,t),yield(0,g.qk)(n)})()}updateProfile(t,i,l,o){var n=this;return(0,f.A)(function*(){const U=(0,d.H9)(n.firestore,`users/${t}`);yield(0,d.BN)(U,{firstName:i,lastName:l,profilePictureUrl:o},{merge:!0})})()}logout(){this.authService.logout()}}return(r=c).\u0275fac=function(t){return new(t||r)(e.rXU(d._7),e.rXU(g.wc),e.rXU(v.Nj),e.rXU(P.Ix),e.rXU(y.u))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-profile"]],decls:27,vars:6,consts:[[3,"fullscreen"],[1,"ion-justify-content-center"],["size","12","size-md","8"],[1,"main-container"],[1,"profile-picture-container"],[1,"profile-avatar"],["alt","Profile Picture",3,"src"],["expand","block",3,"click"],["name","camera",1,"change-photo-icon"],[1,"ion-text-center"],[1,"custom-heading"],["position","floating"],["type","text",3,"ngModelChange","ngModel"],[1,"button-container"],["expand","block","color","primary",3,"click"],[1,"spacer"],["expand","block","color","dark",3,"click"]],template:function(t,i){1&t&&(e.j41(0,"ion-content",0)(1,"ion-grid")(2,"ion-row",1)(3,"ion-col",2)(4,"div",3)(5,"div",4)(6,"ion-avatar",5),e.nrm(7,"img",6),e.k0s(),e.j41(8,"ion-button",7),e.bIt("click",function(){return i.selectImage()}),e.nrm(9,"ion-icon",8),e.k0s()()(),e.j41(10,"div",9)(11,"h1",10),e.EFF(12),e.k0s()(),e.j41(13,"ion-item")(14,"ion-label",11),e.EFF(15,"Nombre"),e.k0s(),e.j41(16,"ion-input",12),e.mxI("ngModelChange",function(o){return e.DH7(i.firstName,o)||(i.firstName=o),o}),e.k0s()(),e.j41(17,"ion-item")(18,"ion-label",11),e.EFF(19,"Apellido"),e.k0s(),e.j41(20,"ion-input",12),e.mxI("ngModelChange",function(o){return e.DH7(i.lastName,o)||(i.lastName=o),o}),e.k0s()(),e.j41(21,"div",13)(22,"ion-button",14),e.bIt("click",function(){return i.saveProfile()}),e.EFF(23,"Modificar Perfil"),e.k0s(),e.nrm(24,"div",15),e.j41(25,"ion-button",16),e.bIt("click",function(){return i.logout()}),e.EFF(26,"Cerrar sesi\xf3n"),e.k0s()()()()()()),2&t&&(e.Y8G("fullscreen",!0),e.R7$(7),e.Y8G("src",i.profilePictureUrl,e.B4B),e.R7$(5),e.Lme("",i.firstName," ",i.lastName,""),e.R7$(4),e.R50("ngModel",i.firstName),e.R7$(4),e.R50("ngModel",i.lastName))},dependencies:[m.BC,m.vS,s.mC,s.Jm,s.hU,s.W9,s.lO,s.iq,s.$w,s.uz,s.he,s.ln,s.Gw],styles:['@charset "UTF-8";ion-button.bt[_ngcontent-%COMP%]{background-color:#fff}.main-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.profile-picture-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}.profile-avatar[_ngcontent-%COMP%]{width:20vh;height:20vh}.change-photo-icon[_ngcontent-%COMP%]{position:absolute;top:75%;left:75%;transform:translate(-50%,-50%);font-size:20px;color:coral;background-color:#00000080;border-radius:50%;padding:5px;cursor:pointer;z-index:10}.button-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:30vh;justify-content:space-between}.spacer[_ngcontent-%COMP%]{flex-grow:1}.custom-heading[_ngcontent-%COMP%]{font-family:Monserrat,sans-serif!important;font-size:30px;color:#333}']}),c})()}];let C=(()=>{var r;class c{}return(r=c).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[P.iI.forChild(N),P.iI]}),c})(),F=(()=>{var r;class c{}return(r=c).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[M.MD,m.YN,s.bv,C]}),c})()}}]);